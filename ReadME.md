# Person Presence Tracker with Analytics Dashboard

This project implements a person presence tracking system using a webcam, YOLOv8 for detection, and an SQLite database for logging. It consists of two separate but interconnected applications:

1.  A **Tkinter-based GUI application** for real-time presence detection, session tracking, and logging.
2.  A **Streamlit-based web dashboard** for visualizing and analyzing the historical presence data from the database.

The two applications share a common SQLite database file (`presence.db`) to store the logged sessions.

## üåü Features

**Real-time Tracker (`app.py`):**

*   **Person Detection:** Real-time detection of persons using the lightweight `yolov8n.pt` model.
*   **Presence Tracking:** Tracks continuous presence sessions in front of the camera.
*   **Session Logging:** Saves each presence session (start time, end time, duration) to an SQLite database.
*   **Absence Timeout:** Automatically ends a session if a person is absent for 3 consecutive seconds.
*   **Tkinter GUI:**
    *   Displays live webcam feed.
    *   Shows real-time detection status (`Detected ‚úÖ` / `Not Detected ‚ùå`).
    *   Displays total presence time for the current day.
    *   Displays the duration of the current active session.
    *   Includes controls: `Start`, `Pause`, `Resume`, `Stop`.

**Analytics Dashboard (`Dashboard.py`):**

*   **Data Reading:** Reads session data directly from the `presence.db` database.
*   **Interactive Visualizations (using Plotly):**
    *   Total presence duration per hour of the day.
    *   Session durations over time (line/scatter plot).
    *   Total presence duration per day.
*   **Key Metrics:** Displays total sessions, total time in selected range, and average session duration.
*   **Date Filtering:** Allows selecting a custom date range for analysis.
*   **Session Table:** Shows detailed start time, end time, and duration for each session in the filtered range.
*   **CSV Export:** Option to download the filtered session data as a CSV file.
*   **Streamlit UI:** Clean, minimal, and interactive web interface.

## üì¶ File Structure

```
.
‚îú‚îÄ‚îÄ app.py               # Tkinter-based live tracker GUI
‚îú‚îÄ‚îÄ Dashboard.py         # Streamlit web app for analytics
‚îú‚îÄ‚îÄ presence.db          # SQLite database (auto-generated by app.py)
‚îú‚îÄ‚îÄ requirements.txt     # Project dependencies
‚îî‚îÄ‚îÄ README.md            # This file
```

## üõ† Technology Stack

*   **Language:** Python 3.x
*   **Object Detection:** Ultralytics YOLOv8n
*   **Image Handling:** OpenCV-Python, Pillow
*   **GUI (Tracker):** Tkinter (Python standard library)
*   **GUI (Dashboard):** Streamlit
*   **Data Manipulation:** Pandas
*   **Visualizations:** Plotly Express
*   **Database:** SQLite3 (Python standard library)

## üíª Setup and Installation

1.  **Clone or Download:** Get the project files onto your local machine.
2.  **Install Dependencies:** Navigate to the project directory in your terminal and install the required packages using pip:

    ```bash
    pip install -r requirements.txt
    ```

3.  **Webcam:** Ensure you have a working webcam connected to your computer.

## üöÄ Usage

The two components are run separately. The tracker (`app.py`) must be run to generate the `presence.db` file that the dashboard (`Dashboard.py`) reads from.

### 1. Run the Presence Tracker (`app.py`)

This will launch the desktop GUI.

```bash
python app.py
```

*   A Tkinter window will appear.
*   Click the **`Start`** button to begin detecting presence and logging sessions.
*   Click **`Pause`** to temporarily stop tracking.
*   Click **`Resume`** to continue tracking after pausing.
*   Click **`Stop`** to end the current session (if active), stop tracking, release the camera, and close the database.
*   Closing the window using the 'X' button will also perform the stop action.
*   A `presence.db` file will be created in the same directory to store your session data.

**Note:** The tracker needs your webcam and might use notable CPU/GPU resources depending on your hardware and the detection interval.

### 2. Run the Analytics Dashboard (`Dashboard.py`)

This will launch the web-based dashboard in your browser. Make sure you have run the tracker at least once so that `presence.db` exists.

```bash
streamlit run Dashboard.py
```

*   Your default web browser should open automatically to the dashboard page (usually `http://localhost:8501`).
*   The dashboard will display summary metrics for today and historical data based on the date range filter in the sidebar.
*   Interact with the charts by hovering or zooming.
*   Use the date inputs in the sidebar to change the historical data displayed.
*   View the session data table and use the button to download it as a CSV.

**Note:** The dashboard only reads data from `presence.db`. It does not affect the running tracker application. You can run it while `app.py` is running or stopped.

## üìä Database Schema

The `presence.db` SQLite database contains a single table named `presence` with the following schema:

```sql
CREATE TABLE presence (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    start_time TEXT,        -- Format: YYYY-MM-DD HH:MM:SS (UTC time string)
    end_time TEXT,          -- Format: YYYY-MM-DD HH:MM:SS (UTC time string)
    duration REAL           -- Duration of the session in seconds
);
```


## ü§ù Contributing

If you have suggestions for improvements or find issues, feel free to open an issue or submit a pull request.
